class Solution { //å›æº¯å›æº¯å›æº¯
public:

    void solveSudoku(vector<vector<char>>& board) {

        int my_board[9][9];

        std::stack<std::pair<int,int>> path;

        int rol[9][10];
        int col[9][10];
        int matrix[9][10];
        for( int i = 0 ; i < 9 ; i++ ){
            for ( int j = 0 ; j <= 9 ; j++ ){
                rol[i][j] = 0;
                col[i][j] = 0;
                matrix[i][j] = 0;
            }
        }

        for( int i = 0; i < 9 ; i++ ){
            for ( int j = 0 ; j < 9 ; j++ ){
                if ( board[i][j] == '.'){
                    my_board[i][j] = -1;
                }
                else{
                    int num = board[i][j] - '0';
                    my_board[i][j] = num;
                    rol[i][num] = 1;
                    col[j][num] = 1;
                    int seq = (i/3)*3 + j/3;
                    matrix[seq][num] = 1;
                }
            }
        }

        int i,j;
        i = j = 0;

        while( i < 9 ){
            int j = 0;
            while ( j < 9 ){
                if ( board[i][j] == '.' && my_board[i][j] == -1 ){//å¡«ç©ºä½
                    
                    for ( int k = 1 ; k <= 9 ; k++){ //ä»0-9åˆ¤æ–­
                        int seq = (i/3)*3 + j/3;
                        if ( rol[i][k] != 1 && col[j][k] != 1 && matrix[seq][k] != 1){
                            my_board[i][j] = k;
                            rol[i][k] = col[j][k] = matrix[seq][k] = 1;

                            path.push(std::make_pair(i,j));//å­˜å…¥æ”¹åŠ¨è·¯å¾„

                            break;
                        }
                    }

                    if ( my_board[i][j] == -1 ){  //å‡å¦‚ç¢°åˆ°æ­»è·¯
                    
                        i = std::get<0>(path.top());
                        j = std::get<1>(path.top());
                        path.pop();
                        continue;
                    }
                }
                else if(board[i][j] == '.' && my_board[i][j] != -1 ){//æ”¹åŠ¨å·²å¡«è¿‡çš„
                    int change = 0; //çœ‹æ˜¯å¦æœ‰æ”¹åŠ¨
                    for ( int k = my_board[i][j] ; k <= 9 ; k++){
                        int seq = (i/3)*3 + j/3;
                        if ( rol[i][k] != 1 && col[j][k] != 1 && matrix[seq][k] != 1){
                            int pre = my_board[i][j];
                            rol[i][pre] = col[j][pre] = matrix[seq][pre] = 0;//ä¸€å®šè¦è®°å¾—æŠŠä¹‹å‰çš„ğŸŒ²ä»–å¦ˆä¸ªé€¼çš„åˆ æ‰å•Šå§æ§½ï¼ŒèŠ±äº†2å°æ—¶æ‰¾bugï¼Œåäº†
                            my_board[i][j] = k;
                            rol[i][k] = col[j][k] = matrix[seq][k] = 1;

                            path.push(std::make_pair(i,j)); //å­˜å…¥æ”¹åŠ¨è·¯å¾„

                            change = 1;
                            break;
                        }
                    }
                    if ( change == 0 ){ //å¦‚æœæ²¡æœ‰æ”¹åŠ¨åˆ™è¯´æ˜èµ°åˆ°æ­»è·¯
                        int seq = (i/3)*3 + j/3;
                        int now = my_board[i][j];

                        my_board[i][j] = -1; //æŠŠè¯¥ç©ºä½è¿˜åŸ

                        rol[i][now] = col[j][now] = matrix[seq][now] = 0;
                        i = std::get<0>(path.top());
                        j = std::get<1>(path.top());
                        path.pop();

                        continue;
                    }
                    
                }
                j += 1;
            }
            i += 1;
        }

        for ( int i = 0 ; i < 9 ; i++ ){
            for ( int j = 0 ; j < 9 ; j++ ){
                std::cout << my_board[i][j] << ' ';
            }
            std::cout << '\n';
        }
        for ( int i = 0 ; i < 9 ; i++ ){
            for ( int j = 0 ; j < 9 ; j++ ){
                if (board[i][j] == '.'){
                    board[i][j] = '0' + my_board[i][j];
                }
            }
            std::cout << '\n';
        }


        return ;
        
    }
};
